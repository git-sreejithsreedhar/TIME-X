<!DOCTYPE HTML>
<html lang="en">


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:32:35 GMT -->
<head>
    <meta charset="utf-8">
    <title>Evara Dashboard</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/static/admAssets/imgs/theme/favicon.svg">
    <!-- Template CSS -->
    <link href="/static/admAssets/css/main.css" rel="stylesheet" type="text/css" />

    
</head>

<body>
    <div class="screen-overlay"></div>
    <aside class="navbar-aside" id="offcanvas_aside">
        <div class="aside-top">
            <a href="index.html" class="brand-wrap">
                <img src="/static/admAssets/imgs/theme/logo.svg" class="logo" alt="Evara Dashboard">
            </a>
            <div>
                <button class="btn btn-icon btn-aside-minimize"> <i class="text-muted material-icons md-menu_open"></i> </button>
            </div>
        </div>
        <nav>
            <ul class="menu-aside">
                <li class="menu-item active">
                    <a class="menu-link" href="/admin"> <i class="icon material-icons md-home"></i>
                        <span class="text">Dashboard</span>
                    </a>
                </li>

                <li class="menu-item">
                    <a class="menu-link" disabled href="/admin/category"> <i class="icon material-icons md-pie_chart"></i>
                        <span class="text">Category</span>
                    </a>
                </li>
                
                <li class="menu-item">
                    <a class="menu-link" href="/admin/products"> <i class="icon material-icons md-shopping_bag"></i>
                        <span class="text">Product</span>
                    </a>
                </li>

                <li class="menu-item">
                    <a class="menu-link" href="/admin/brand"> <i class="icon material-icons md-stars"></i>
                        <span class="text">Brands</span> </a>
                </li>

                <li class="menu-item">
                    <a class="menu-link" href="/admin/getOrder"> <i class="icon material-icons md-shopping_cart"></i>
                        <span class="text">Orders</span> </a>
                </li>

                <li class="menu-item active">
                    <a class="menu-link" href="/admin/coupon"> <i class="icon material-icons md-monetization_on"></i>
                        <span class="text">Coupon</span>
                    </a>
                </li>

                <li class="menu-item">
                    <a class="menu-link" href="/admin/customer"> <i class="icon material-icons md-person"></i>
                        <span class="text">Customer</span>
                    </a>
                </li>

                <li class="menu-item has-submenu">
                    <a class="menu-link" href="#"> <i class="icon material-icons md-person"></i>
                        <span class="text">Account</span>
                    </a>
                    <div class="submenu">
                        <a href="page-account-login.html">User login</a>
                        <a href="page-account-register.html">User registration</a>
                        <a href="page-error-404.html">Error 404</a>
                    </div>
                </li>
                
            </ul>
            <hr>
            <ul class="menu-aside">
                <!-- <li class="menu-item has-submenu">
                    <a class="menu-link" href="/admin/logout"> <i class="icon material-icons md-settings"></i>
                        <span class="text">Logout</span>
                    </a>
                </li> -->
            </ul>
            <br>
            <br>
        </nav>
    </aside>

    
    <main class="main-wrap">
        <header class="main-header navbar">
            <div class="col-search">
                <form class="searchform">
                    <div class="input-group">
                        <input list="search_terms" type="text" class="form-control" placeholder="Search term">
                        <button class="btn btn-light bg" type="button"> <i class="material-icons md-search"></i></button>
                    </div>
                    <datalist id="search_terms">
                        <option value="Products">
                        <option value="New orders">
                        <option value="Apple iphone">
                        <option value="Ahmed Hassan">
                    </datalist>
                </form>
            </div>
            <div class="col-nav">
                <button class="btn btn-icon btn-mobile me-auto" data-trigger="#offcanvas_aside"> <i class="material-icons md-apps"></i> </button>
                <ul class="nav">
                    <li class="nav-item">
                        <a class="nav-link btn-icon" href="#">
                            <i class="material-icons md-notifications animation-shake"></i>
                            <span class="badge rounded-pill">3</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link btn-icon darkmode" href="#"> <i class="material-icons md-nights_stay"></i> </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="requestfullscreen nav-link btn-icon"><i class="material-icons md-cast"></i></a>
                    </li>
                    <li class="dropdown nav-item">
                        <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownLanguage" aria-expanded="false"><i class="material-icons md-public"></i></a>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownLanguag3q1e">
                            <a class="dropdown-item text-brand" href="#"><img src="/static/admAssets/imgs/theme/flag-us.png" alt="English">English</a>
                            <a class="dropdown-item" href="#"><img src="/static/admAssets/imgs/theme/flag-fr.png" alt="Français">Français</a>
                            <a class="dropdown-item" href="#"><img src="/static/admAssets/imgs/theme/flag-jp.png" alt="Français">日本語</a>
                            <a class="dropdown-item" href="#"><img src="/static/admAssets/imgs/theme/flag-cn.png" alt="Français">中国人</a>
                        </div>
                    </li>
                    <li class="dropdown nav-item">
                        <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownAccount" aria-expanded="false"> <img class="img-xs rounded-circle" src="/static/admAssets/imgs/people/avatar5.jpeg" alt="User"></a>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownAccount">
                            <a class="dropdown-item" href="#"><i class="material-icons md-perm_identity"></i>Edit Profile</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-settings"></i>Account Settings</a>
                            <a class="dropdown-item" href="#"><i class="material-icons md-help_outline"></i>Help center</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item text-danger" href="/admin/logout"><i class="material-icons md-exit_to_app"></i>Logout</a>
                        </div>
                    </li>
                </ul>
            </div>
        </header>

        
        <section class="content-main">
            <div class="content-header">
                <div>
                    <h2 class="content-title card-title">Time - X</h2>
                    <p>Where The Space bounds Time</p>
                </div>
                <div>
                    <a href="#" class="btn btn-primary"><i class="text-muted material-icons md-post_add"></i>Create report</a>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-3">
                    <div class="card card-body mb-4">
                        <article class="icontext">
                            <span class="icon icon-sm rounded-circle bg-primary-light"><i class="text-primary material-icons md-monetization_on"></i></span>
                            <div class="text">
                                <h6 class="mb-1 card-title">Revenue</h6>
                                <span> ₹ <%= orderAmount %>.00</span>
                                <span class="text-sm">
                                    Shipping fees are not included
                                </span>
                            </div>
                        </article>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="card card-body mb-4">
                        <article class="icontext">
                            <span class="icon icon-sm rounded-circle bg-success-light"><i class="text-success material-icons md-local_shipping"></i></span>
                            <div class="text">
                                <h6 class="mb-1 card-title">Orders</h6> <span><%= count %></span>
                                <span class="text-sm">
                                   Total Completed Orders
                                </span>
                            </div>
                        </article>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="card card-body mb-4">
                        <article class="icontext">
                            <span class="icon icon-sm rounded-circle bg-warning-light"><i class="text-warning material-icons md-qr_code"></i></span>
                            <div class="text">
                                <h6 class="mb-1 card-title">Products</h6> <span><%=productsNumber%></span>
                                <span class="text-sm">
                                    In <%= categories %> categories.
                                </span>
                            </div>
                        </article>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="card card-body mb-4">
                        <article class="icontext">
                            <span class="icon icon-sm rounded-circle bg-info-light"><i class="text-info material-icons md-shopping_basket"></i></span>
                            <div class="text">
                                <h6 class="mb-1 card-title">Overall Discount</h6> <span>₹ <%= discountAmount %>.00</span>
                                <span class="text-sm">
                                    Based on the purchases.
                                </span>
                            </div>
                        </article>
                    </div>
                </div>
            </div>
            
            <div class="row justify-content-center">
    <div class="col-xl-8 col-lg-12">
        <div class="card mb-4">
            <article class="card-body">
                <h5 class="card-title">Sale statistics</h5>
                <canvas id="myChart" height="120px"></canvas>
            </article>
        </div>
    </div>
</div>

                    
<div class="card mb-4">
    <!-- <header class="card-header">
        <h4 class="card-title">Latest orders</h4>
        <div class="row align-items-center">
            <div class="col-md-3 col-12 me-auto mb-md-0 mb-3">
                <div class="custom_select">
                    <select class="form-select select-nice"> 
                        <option value="daily">Daily</option>
                        <option value="weekly">Weekly</option>
                        <option value="monthly">Monthly</option>
                        <option value="yearly">Yearly</option>
                        <option value="custom">Custom</option>
                    </select>
                </div>
                <div class="col-md-2 col-6">
                    <button id="generate_report_btn" class="btn btn-primary btn-sm">Generate</button>
                </div>
                
            </div>
                
                <div class="col-md-2 col-6">
                    <label for="start_date" style="color: #000; font-weight: bold;font-size: 16px;">Start Date</label>
                    <input type="date" id="start_date" name="start_date" value="2021-05-02" class="form-control" max="<%= currentDate %>">
                </div>
                <div class="col-md-2 col-6">
                    <label for="end_date" style="color: #000; font-weight: bold; font-size: 16px;">End Date</label>
                    <input type="date" id="end_date" name="end_date" value="2021-05-02" class="form-control" max="<%= currentDate %>">
                </div> -->


            

           

            <!-- <div class="col-md-2 col-6">
                <input type="date" value="02.05.2021" class="form-control">
            </div> -->
            <!-- <div class="col-md-2 col-6">
                <div class="custom_select">
                    <select class="form-select select-nice">
                        <option selected>Status</option>
                        <option>All</option>
                        <option>Paid</option>
                        <option>Chargeback</option>
                        <option>Refund</option>
                    </select>
                </div>
            </div> -->

        <!-- </div>
    </header> -->

    <div class="card mb-4">
        <header class="card-header">
            <h4 class="card-title">Sales Report</h4>
            <div class="row align-items-center">    
                <div class="col-lg-7">
                    <div class="d-flex align-items-center mb-3">
                        <label for="startDate" class="me-2">Start Date:</label>
                        <input type="date" id="startDate" class="form-control me-2">
                        <label for="endDate" class="me-2">End Date:</label>
                        <input type="date" id="endDate" class="form-control me-2">
                    </div>
                    <span id="dateError" style="color: red;"></span>
                    <br><br>
                    <div class="d-flex align-items-center gap-3 mb-3">
                        <button class="btn btn-primary" id="yearlyReportButton">Yearly Report</button>
                        <button class="btn btn-primary" id="weeklyReportButton">Weekly Report</button>
                        <button class="btn btn-primary" id="todayReportButton">Today's Report</button>
                    </div>
                    <div class="d-flex align-items-center mb-3">
                        <button class="btn btn-primary" id="createReportButton">Create Report</button>
                    </div>
                    <div class="d-flex align-items-center gap-3">
                        <button id="downloadButton" class="btn btn-primary" style="display: none;" onclick="downloadPdf()">
                            <i class="text-muted material-icons md-download"></i>Download Report
                        </button>
                        <button id="downloadExcelButton" class="btn btn-primary" style="display: none;" onclick="downloadExcel()">
                            <i class="text-muted material-icons md-download"></i>Download Excel
                        </button>
                    </div>
                </div>
            </div>
        </header>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table align-middle table-nowrap mb-0" id="reportContainer">
                    <thead class="table-light">
                        <tr>
                            <th class="align-middle" scope="col">Sl.No</th>
                            <th class="align-middle" scope="col">Order ID</th>
                            <th class="align-middle" scope="col">Billing Name</th>
                            <th class="align-middle" scope="col">Date</th>
                            <th class="align-middle" scope="col">Total</th>
                            <th class="align-middle" scope="col">Payment Status</th>
                            <th class="align-middle" scope="col">Payment Method</th>
                        </tr>
                    </thead>
                    <tbody id="reportTableBody">
                   

                        <% orders.forEach ((row, index) => { %> 
                        <tr>
                            <td class="align-middle"text-center> <%= index+1 %> </td>
                            <td><a href="#" class="fw-bold"><%= row.trackingId %></a> </td>
                            <td><%= row.billingdetails.name %></td>
                            <td>
                                <%= row.orderDate%>
                            </td>
                            <td>
                                <%= row.amount %>
                            </td>
                            <td>
                                <% if (row.paymentStatus === 'Paid') { %>
                                    <span class="badge badge-pill badge-soft-success"><%= row.paymentStatus %></span>
                                <% } else if (row.paymentStatus === 'Failed') { %>
                                    <span class="badge badge-pill badge-soft-danger"><%= row.paymentStatus %></span>
                                <% } else { %>
                                    <span class="badge badge-pill badge-soft-warning"><%= row.paymentStatus %></span>
                                <% } %>
                            </td>
                            
                            <td>
                                <i class="material-icons md-payment font-xxl text-muted mr-5"></i> <%= row.paymentMethod %>
                            </td>
                            <!-- <td>
                                <a href="#" class="btn btn-xs"> View details</a>
                            </td> -->
                        </tr>
                        <%})%>
                        <tr>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div> <!-- table-responsive end// -->
    </div>
</div>

             
<!-- 
            <div class="pagination-area mt-30 mb-50">
                <nav aria-label="Page navigation example">
                    <ul class="pagination justify-content-start">
                        <li class="page-item active"><a class="page-link" href="#">01</a></li>
                        <li class="page-item"><a class="page-link" href="#">02</a></li>
                        <li class="page-item"><a class="page-link" href="#">03</a></li>
                        <li class="page-item"><a class="page-link dot" href="#">...</a></li>
                        <li class="page-item"><a class="page-link" href="#">16</a></li>
                        <li class="page-item"><a class="page-link" href="#"><i class="material-icons md-chevron_right"></i></a></li>
                    </ul>
                </nav>
            </div> -->
        </section> <!-- content-main end// -->
        <footer class="main-footer font-xs">
            <div class="row pb-30 pt-15">
                <div class="col-sm-6">
                    <script>
                    document.write(new Date().getFullYear())
                    </script> ©, Evara - HTML Ecommerce Template .
                </div>
                <div class="col-sm-6">
                    <div class="text-sm-end">
                        All rights reserved
                    </div>
                </div>
            </div>
        </footer>
    </main>
    <script src="/static/admAssets/js/vendors/jquery-3.6.0.min.js"></script>
    <script src="/static/admAssets/js/vendors/bootstrap.bundle.min.js"></script>
    <script src="/static/admAssets/js/vendors/select2.min.js"></script>
    <script src="/static/admAssets/js/vendors/perfect-scrollbar.js"></script>
    <script src="/static/admAssets/js/vendors/jquery.fullscreen.min.js"></script>
    <script src="/static/admAssets/js/vendors/chart.js"></script>
    <!-- Main Script -->
    <script src="/static/admAssets/js/main.js" type="text/javascript"></script>
    <script src="/static/admAssets/js/custom-chart.js" type="text/javascript"></script>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Include html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Include jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Include XLSX -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>


<!-- validation of dates -------------------------->
    <script>
        const startDateInput = document.getElementById('startDate');
        const endDateInput = document.getElementById('endDate');
        const dateErrorSpan = document.getElementById('dateError');
    
        startDateInput.addEventListener('change', validateDates);
        endDateInput.addEventListener('change', validateDates);
    
        function validateDates() {
            const startDate = new Date(startDateInput.value);
            const endDate = new Date(endDateInput.value);
    
            // Reset error message
            dateErrorSpan.textContent = '';
    
    
            if (endDate < startDate || endDate > new Date() || startDate > new Date() || startDate > endDate)  {
                dateErrorSpan.textContent = 'Invalid details. Choose correct date';
                endDateInput.value = '';
            } 
    
            // Hide error message after 3 seconds
            setTimeout(() => {
                dateErrorSpan.textContent = '';
            }, 3000);
        }
    </script>

<script>
    $(document).ready(function () {
        $('#yearlyReportButton').click(function () {
            const currentDate = new Date();
            const yearStart = new Date(currentDate.getFullYear() - 1, 0, 1).toISOString().split('T')[0];
            const yearEnd = new Date(currentDate.getFullYear() - 1, 11, 31).toISOString().split('T')[0];
            $('#startDate').val(yearStart);
            $('#endDate').val(yearEnd);
        });

        $('#weeklyReportButton').click(function () {
            const currentDate = new Date();
            const weekStart = new Date(currentDate.setDate(currentDate.getDate() - currentDate.getDay() + 1)).toISOString().split('T')[0];
            const weekEnd = new Date(currentDate.setDate(currentDate.getDate() - currentDate.getDay() + 7)).toISOString().split('T')[0];
            $('#startDate').val(weekStart);
            $('#endDate').val(weekEnd);
        });

        $('#todayReportButton').click(function () {
            const currentDate = new Date();
            const dayStart = currentDate.toISOString().split('T')[0];
            const dayEnd = currentDate.toISOString().split('T')[0];
            $('#startDate').val(dayStart);
            $('#endDate').val(dayEnd);
        });

        $('#createReportButton').click(function () {
            $.ajax({
                url: '/generate-report',
                type: 'POST',
                data: {
                    startDate: $('#startDate').val(),
                    endDate: $('#endDate').val()
                },
                success: function (response) {
                    $('#reportTableBody').empty();
                    response.reportData.forEach((order, index) => {
                        let productsHTML = '';
                        order.products.forEach(product => {
                            productsHTML += `<li>${product.productName} - ${product.quantity} - ${product.price}</li>`;
                        });
                        let row = `<tr>
                                        <td>${index + 1}</td>
                                        <td>#${order.orderId}</td>
                                        <td>${order.firstName}</td>
                                        <td>${new Date(order.date).toLocaleDateString()}</td>
                                        <td>Rs.${order.totalPrice.toFixed(2)}</td>
                                        <td>${order.paymentStatus}</td>
                                        <td>${order.paymentMethod}</td>
                                    </tr>`;
                        $('#reportTableBody').append(row);
                    });
                    $('#reportContainer').show();
                    $('#downloadButton').show();
                    $('#downloadExcelButton').show();
                },
                error: function (xhr, status, error) {
                    console.error(error);
                }
            });
        });
    });

    

    function downloadPdf() {
            html2canvas(document.getElementById("reportContainer")).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const { jsPDF } = window.jspdf; // Ensure jsPDF is correctly referenced
                const pdf = new jsPDF({
                    orientation: "portrait",
                    unit: "pt",
                    format: [canvas.width, canvas.height]
                });
                const width = pdf.internal.pageSize.getWidth();
                const height = (canvas.height * width) / canvas.width;

                pdf.addImage(imgData, 'PNG', 0, 0, width, height);
                pdf.save("report.pdf");
            }).catch(err => {
                console.error("Error generating PDF: ", err);
            });
        }

    function downloadExcel() {
        const element = document.getElementById('reportContainer');
        const wb = XLSX.utils.table_to_book(element);
        XLSX.writeFile(wb, 'report.xlsx');
    }
</script>


<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script> -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script> -->


</body>


<!-- Mirrored from wp.alithemes.com/html/evara/evara-backend/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 01 Aug 2021 15:32:57 GMT -->
</html>